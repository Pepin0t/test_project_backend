# Как это работает?

### Ниже представлено описание запуска приложения в режиме development!

**Для полноценной работы Вам потребуется установленная [MongoDB](https://www.mongodb.com/) или ее облачная альтернатива [mLab](https://mlab.com/welcome/).**    
**Еще нужен Telegram-бот, который может совпадать с тем, о котором говорится [здесь](https://github.com/Pepin0t/test_project_frontend).**

#### Порядок запуска:

1.  Клонируйте данный репозиторий в папку `some_dir/server`

2.  Клонируйте репозиторий [test_project_frontend](https://github.com/Pepin0t/test_project_frontend) в папку `some_dir/client`

3.  Установите все требуемые зависимости

4.  Установите [nodemon](https://github.com/remy/nodemon) глобально:

    ```sh
    npm i nodemon -g
    ```

5.  Запуск приложения (клиент + сервер) осуществляется через терминал из папки `some_dir/server` следующей командой:

    ```sh
    npm run dev
    ```

#### Переменные окружения:

```sh
PORT=5000

Собственно порт. Должен совпадать с портом, указанным в файле webpack.config.js на клиенте:

{
    ...
    proxy: {
        "/api": {
	        target: "http://localhost:5000",
            ...
            }
}
```

```sh
MONGO_URI=

Адрес БД.
Пример: mongodb://kuku:kuku1111@ds123456.mlab.com:12345/somedb
```

```sh
MONGO_URI2=

Дополнительный адрес адрес БД, если он Вам нужен. Не обязателен, так как используется только один.
Пример: mongodb://localhost:27017/somedb
```

```sh
EXCHANGE_RATES_MONGO_ID=

_id документа с курсами валют в БД.
Пример: 5c46207de67b885144be3627
```

```sh
SECRET_KEY=

Секретный ключ для подписи и валидации JSON Web Token.
Пример: jdf139hf0213hf
```


```sh
Для администратора!

TELEGRAM_GROUP_CHAT_ID=

Id Telegram-бота для чата группы. Позволит боту отправлять сообщения в группу в Telegram.
Пример: -212783961
```

```sh
Для администратора!

TELEGRAM_BOT_CHAT_ID=

Id Telegram-бота для личного чата. Позволит боту отправлять Вам личные сообщения.

Пример: 202113936

```

```sh
Для администратора!

TELEGRAM_TOKEN=

Токен Telegram-бота.
Пример: 325814221:DAFDr7wVt1PXdlF43rrUV8OWcetHX9YkexQ
```

#### Хотите стать администратором? Инструкция:

1.  Запустите все это дело (инструкция выше).

2.  Зарегистрируйтесь как обычный пользователь.

3.  Найдите в БД любым удобным способом коллекцию users, а там - документ пользователя с Вашим логином.

4.  Измените в документе поле audience с "user" на "admin".

5.  Войдите.

6.  Получите от Telegram-бота проверочный код и введите его в появившуюся форму.
    Если код по каким-то причинам не пришел, найтите в БД коллекцию verifications и посмотрите в документе.

7.  Радуйтесь! Вы - администратор! При повторном входе выполнять пункты 2-4 не требуется.


